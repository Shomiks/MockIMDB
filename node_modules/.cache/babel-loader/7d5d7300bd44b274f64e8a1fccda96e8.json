{"ast":null,"code":"var _jsxFileName = \"/Users/milosdjurkovic/MockIMDB/src/Component/Movie page/Single movie/Comments/commentsForm.js\";\nimport React, { useContext } from \"react\";\nimport styled from \"styled-components\";\nimport { useForm } from \"react-hook-form\";\nimport { __RouterContext as RouterContext } from \"react-router\";\nimport { CommentsContext } from \"../index\";\nimport axios from \"axios\";\nconst WriteCommentError = styled.div`\n  color: red;\n`;\nconst CommentTextarea = styled.textarea`\n  width: 100%;\n  min-height: 100px;\n`;\n\nconst CommentForm = () => {\n  const [movie, setMovie] = useContext(CommentsContext);\n  const comments = movie.comments;\n  const {\n    register,\n    handleSubmit,\n    errors,\n    reset\n  } = useForm();\n\n  const useRouter = () => useContext(RouterContext);\n\n  const {\n    match\n  } = useRouter();\n  const movieId = match.params.id;\n  const lastCommentId = comments.length ? comments[comments.length - 1].id : 0;\n\n  const onSubmit = comment => {\n    reset();\n    const newComment = {\n      comment: comment.comment,\n      movieId: movieId\n    };\n    axios.post(`http://localhost:5000/api/comments?${movieId}=1`, { ...newComment\n    }).then(setMovie(prevState => ({ ...prevState,\n      comments: [...comments, newComment]\n    }))).catch(() => alert(\"Maximum API requests reached\"));\n  };\n\n  return /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit(onSubmit),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(CommentTextarea, {\n    placeholder: \"Write comment\",\n    name: \"text\",\n    ref: register({\n      required: true\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }\n  }), errors.text && /*#__PURE__*/React.createElement(WriteCommentError, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 9\n    }\n  }, \"This field is required\"));\n};\n\nexport default CommentForm;","map":{"version":3,"sources":["/Users/milosdjurkovic/MockIMDB/src/Component/Movie page/Single movie/Comments/commentsForm.js"],"names":["React","useContext","styled","useForm","__RouterContext","RouterContext","CommentsContext","axios","WriteCommentError","div","CommentTextarea","textarea","CommentForm","movie","setMovie","comments","register","handleSubmit","errors","reset","useRouter","match","movieId","params","id","lastCommentId","length","onSubmit","comment","newComment","post","then","prevState","catch","alert","required","text"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,UAAhB,QAAkC,OAAlC;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,SAASC,OAAT,QAAwB,iBAAxB;AACA,SAASC,eAAe,IAAIC,aAA5B,QAAiD,cAAjD;AACA,SAASC,eAAT,QAAgC,UAAhC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,MAAMC,iBAAiB,GAAGN,MAAM,CAACO,GAAI;;CAArC;AAIA,MAAMC,eAAe,GAAGR,MAAM,CAACS,QAAS;;;CAAxC;;AAKA,MAAMC,WAAW,GAAG,MAAM;AACxB,QAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBb,UAAU,CAACK,eAAD,CAApC;AACA,QAAMS,QAAQ,GAAGF,KAAK,CAACE,QAAvB;AACA,QAAM;AAAEC,IAAAA,QAAF;AAAYC,IAAAA,YAAZ;AAA0BC,IAAAA,MAA1B;AAAkCC,IAAAA;AAAlC,MAA4ChB,OAAO,EAAzD;;AACA,QAAMiB,SAAS,GAAG,MAAMnB,UAAU,CAACI,aAAD,CAAlC;;AACA,QAAM;AAAEgB,IAAAA;AAAF,MAAYD,SAAS,EAA3B;AACA,QAAME,OAAO,GAAGD,KAAK,CAACE,MAAN,CAAaC,EAA7B;AACA,QAAMC,aAAa,GAAGV,QAAQ,CAACW,MAAT,GAAkBX,QAAQ,CAACA,QAAQ,CAACW,MAAT,GAAkB,CAAnB,CAAR,CAA8BF,EAAhD,GAAqD,CAA3E;;AAEA,QAAMG,QAAQ,GAAIC,OAAD,IAAa;AAC5BT,IAAAA,KAAK;AACL,UAAMU,UAAU,GAAG;AACjBD,MAAAA,OAAO,EAAEA,OAAO,CAACA,OADA;AAEjBN,MAAAA,OAAO,EAAEA;AAFQ,KAAnB;AAIAf,IAAAA,KAAK,CACFuB,IADH,CACS,sCAAqCR,OAAQ,IADtD,EAC2D,EACvD,GAAGO;AADoD,KAD3D,EAIGE,IAJH,CAKIjB,QAAQ,CAAEkB,SAAD,KAAgB,EACvB,GAAGA,SADoB;AAEvBjB,MAAAA,QAAQ,EAAE,CAAC,GAAGA,QAAJ,EAAcc,UAAd;AAFa,KAAhB,CAAD,CALZ,EAUGI,KAVH,CAUS,MAAMC,KAAK,CAAC,8BAAD,CAVpB;AAWD,GAjBD;;AAmBA,sBACE;AAAM,IAAA,QAAQ,EAAEjB,YAAY,CAACU,QAAD,CAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,eAAD;AACE,IAAA,WAAW,EAAC,eADd;AAEE,IAAA,IAAI,EAAC,MAFP;AAGE,IAAA,GAAG,EAAEX,QAAQ,CAAC;AAAEmB,MAAAA,QAAQ,EAAE;AAAZ,KAAD,CAHf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAME;AAAO,IAAA,IAAI,EAAC,QAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANF,EAOGjB,MAAM,CAACkB,IAAP,iBACC,oBAAC,iBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BARJ,CADF;AAaD,CAzCD;;AA2CA,eAAexB,WAAf","sourcesContent":["import React, { useContext } from \"react\";\nimport styled from \"styled-components\";\nimport { useForm } from \"react-hook-form\";\nimport { __RouterContext as RouterContext } from \"react-router\";\nimport { CommentsContext } from \"../index\";\nimport axios from \"axios\";\n\nconst WriteCommentError = styled.div`\n  color: red;\n`;\n\nconst CommentTextarea = styled.textarea`\n  width: 100%;\n  min-height: 100px;\n`;\n\nconst CommentForm = () => {\n  const [movie, setMovie] = useContext(CommentsContext);\n  const comments = movie.comments;\n  const { register, handleSubmit, errors, reset } = useForm();\n  const useRouter = () => useContext(RouterContext);\n  const { match } = useRouter();\n  const movieId = match.params.id;\n  const lastCommentId = comments.length ? comments[comments.length - 1].id : 0;\n\n  const onSubmit = (comment) => {\n    reset();\n    const newComment = {\n      comment: comment.comment,\n      movieId: movieId,\n    };\n    axios\n      .post(`http://localhost:5000/api/comments?${movieId}=1`, {\n        ...newComment,\n      })\n      .then(\n        setMovie((prevState) => ({\n          ...prevState,\n          comments: [...comments, newComment],\n        }))\n      )\n      .catch(() => alert(\"Maximum API requests reached\"));\n  };\n\n  return (\n    <form onSubmit={handleSubmit(onSubmit)}>\n      <CommentTextarea\n        placeholder=\"Write comment\"\n        name=\"text\"\n        ref={register({ required: true })}\n      />\n      <input type=\"submit\" />\n      {errors.text && (\n        <WriteCommentError>This field is required</WriteCommentError>\n      )}\n    </form>\n  );\n};\n\nexport default CommentForm;\n"]},"metadata":{},"sourceType":"module"}